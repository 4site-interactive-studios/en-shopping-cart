(()=>{"use strict";new(function(){function t(){var t=this;this.cardsNode=document.querySelectorAll(".sc-cards > div:not(.block-other)"),this.total=0,this.currencies={USD:"$",EUR:"€",GBP:"£",CAD:"$",AUD:"$"},this.additionalComments=document.querySelector("[name='transaction.comments']"),this.cartItems="",this.log("Shopping Cart: Debug mode is on"),this.shouldRun()?(this.additionalComments||this.createAdditionalComments(),"loading"!==document.readyState?this.run():document.addEventListener("DOMContentLoaded",(function(){t.run()}))):this.log("Shopping Cart Not Running")}return t.prototype.shouldRun=function(){return this.cardsNode.length>0},t.prototype.run=function(){for(var t=this;!this.checkNested(window.EngagingNetworks,"require","_defined","enjs","setFieldValue");)return this.log("4Site Shoppint Cart - Waiting for EngagingNetworks"),void window.setTimeout((function(){t.run()}),10);if(this.setCardsAtttributes(),this.createCardsAmounts(),this.createCardsQuantity(),this.createCardsImageFlip(),this.watchForQuantityChanges(),this.setQuantityClickEvent(),this.addLiveVariables(),this.addOtherAmount(),this.addMonthlyCheckbox(),this.checkDebug(),"Y"===(localStorage.getItem("sc-cards-".concat(this.getPageId(),"-monthly"))||window.EngagingNetworks.require._defined.enjs.getFieldValue("recurrpay"))){this.updateFrequency("monthly");var e=document.querySelector("#sc-monthly");e&&(e.checked=!0)}else this.updateFrequency("onetime");this.renderFrequency(),window.setTimeout((function(){t.updateTotal()}),500)},t.prototype.renderFrequency=function(){var t=this,e=document.querySelector(".frequency-buttons");if(e){var n=e.querySelectorAll("div"),a=window.EngagingNetworks.require._defined.enjs.getFieldValue("recurrpay");n.forEach((function(t){var e=t.innerText,n=t.className.split(" ")[0],r="monthly"===n?"Y"===a:"N"===a,i='\n          <input id="frequency-'.concat(n,'" type="radio" name="sc-frequency" value="').concat(n,'" ').concat(r?"checked":"",' />\n          <label for="frequency-').concat(n,'">\n            ').concat("monthly"===n?'\n      <div class="monthly-icon">\n      <svg id="monthly-icon-heart" width="21" height="16" viewBox="0 0 21 16" fill="none" xmlns="http://www.w3.org/2000/svg">\n          <path d="M9.972 15.107c-.443-.427-1.508-1.255-2.393-1.871-2.635-1.752-2.997-2.013-4.063-2.889C1.546 8.737.701 7.127.701 4.95c0-1.066.08-1.468.422-2.107C1.707 1.776 2.551.972 3.617.498 4.381.142 4.763 0 6.03 0c1.328 0 1.61.142 2.393.521.966.474 1.93 1.468 2.152 2.155l.12.426.303-.592c1.749-3.386 7.34-3.338 9.29.095.624 1.089.684 3.41.141 4.712-.724 1.704-2.051 3.007-5.148 4.996-2.031 1.302-4.344 3.29-4.505 3.551-.16.332.02.048-.804-.758z"/>\n      </svg>\n      <svg id="monthly-icon-paw" width="38" height="31" viewBox="0 0 38 31" fill="none" xmlns="http://www.w3.org/2000/svg">\n        <path id="p1" d="M6.45749 19.1425C9.19966 9.11877 16.8581 11.1737 18.5133 11.1738C20.1684 11.1739 28.192 9.52885 30.2178 19.1425C33.8793 36.5187 23.7721 29.6687 18.7973 29.6687C13.8225 29.6687 3.73797 36.3754 6.45749 19.1425Z"/>\n        <path d="M18 4C18 6.20914 15.9853 8 13.5 8C11.0147 8 9 6.20914 9 4C9 1.79086 11.0147 0 13.5 0C15.9853 0 18 1.79086 18 4Z"/>\n        <path d="M29 4C29 6.20914 26.9853 8 24.5 8C22.0147 8 20 6.20914 20 4C20 1.79086 22.0147 0 24.5 0C26.9853 0 29 1.79086 29 4Z"/>\n        <path d="M8 11C8 13.2091 6.20914 15 4 15C1.79086 15 0 13.2091 0 11C0 8.79086 1.79086 7 4 7C6.20914 7 8 8.79086 8 11Z"/>\n        <path d="M38 11C38 13.2091 36.2091 15 34 15C31.7909 15 30 13.2091 30 11C30 8.79086 31.7909 7 34 7C36.2091 7 38 8.79086 38 11Z"/>\n        <animate id="paw-to-heart" xlink:href="#p1" fill="freeze" attributeName="d" to="M19.6324 7.31636C20.1715 6.01409 20.1116 3.69369 19.4927 2.60453C18.4794 0.808119 16.7543 0.00272001 15.0118 0.0178418C12.5177 0.0178418 11.0213 0.999756 9.96961 3.10176C9.39422 1.05455 7.32189 0 5.33784 0C3.29283 0 1.46294 1.00755 0.466507 2.8413C-0.322742 4.32795 -0.0270404 6.46379 0.731797 7.90055C1.78089 9.88687 3.86495 11.2059 5.67154 12.4268C7.29271 13.5224 9.52481 14.9998 9.96904 15.9996C10.0236 15.4998 13.0165 13.2859 14.5215 12.3123C17.596 10.3234 18.9137 9.02114 19.6324 7.31636Z" dur="1s" begin="indefinite"/>\n      </svg>\n      </div>\n      ':"","\n            <span>").concat(e,"</span>\n          </label>\n        ");t.innerHTML=i})),e.querySelectorAll("input").forEach((function(e){e.addEventListener("change",(function(e){var n=e.target.value;t.updateFrequency(n),localStorage.setItem("sc-cards-".concat(t.getPageId(),"-monthly"),n);var a=document.querySelector("#sc-monthly");a&&(a.checked="monthly"===n,a.dispatchEvent(new Event("change")))}))}))}},t.prototype.setCardsAtttributes=function(){var t=this,e=JSON.parse(localStorage.getItem("sc-cards-".concat(this.getPageId()))||"[]");this.cardsNode.forEach((function(n,a){var r=n.querySelector("h1 + p, h2 + p, h3 + p, h4 + p, h5 + p, h6 + p");if(r){var i=r.innerText.match(/(\d+)([,.](\d{1,2}))?/),c=i?parseFloat(i[1]+"."+(i[3]||"0")):0,o=e[a]||0;c>0&&(n.setAttribute("data-amount",c.toFixed(2)),n.setAttribute("data-quantity",o.toString()),n.setAttribute("data-card",a.toString()),n.setAttribute("data-currency-symbol",t.getCurrencySymbol(n)),n.setAttribute("data-currency-position",t.getCurrencyPosition(n)),n.setAttribute("data-currency-code",t.getCurrencyCode(n)),o>0&&n.setAttribute("data-selected","true"))}}))},t.prototype.createCardsImageFlip=function(){this.cardsNode.forEach((function(t){var e=t.querySelector("p:first-child");if(e){var n=e.querySelectorAll("img");if(n.length>1){var a=document.createElement("div");a.classList.add("sc-card-image-inner"),e.classList.add("sc-card-image-flip"),n[0].classList.add("sc-card-image-front"),n[1].classList.add("sc-card-image-back"),a.appendChild(n[0]),a.appendChild(n[1]),e.innerHTML="",e.appendChild(a),t.setAttribute("data-flip","true")}}}))},t.prototype.createCardsAmounts=function(){var t=this;this.cardsNode.forEach((function(e){var n=t.getCardAmount(e),a="";if(n%1==0)a=n.toString();else{var r=n.toString().split(".")[1];1===r.length&&(r+="0"),a="".concat(n.toString().split(".")[0],'<span class="decimal">').concat(r,"</span>")}var i=t.getCurrencySymbol(e),c=t.getCurrencyPosition(e),o=document.createElement("div");o.classList.add("sc-cards-amount"),o.classList.add("position-".concat(c)),o.innerHTML='<span class="currency">'.concat(i,'</span><span class="amount">').concat(a,"</span>"),e.appendChild(o)}))},t.prototype.createCardsQuantity=function(){var t=this;this.cardsNode.forEach((function(e){var n=e.querySelector("h1 + p, h2 + p, h3 + p, h4 + p, h5 + p, h6 + p"),a=t.getCardQuantity(e),r=document.createElement("div");r.classList.add("sc-cards-quantity"),r.innerHTML='\n        <div class="decrease"></div>\n        <div class="quantity">'.concat(a,'</div>\n        <div class="increase"></div>\n      '),n.parentNode.insertBefore(r,n.nextSibling)}))},t.prototype.increaseQuantity=function(t){var e=this.getCardQuantity(t)+1;t.setAttribute("data-quantity",e.toString()),t.setAttribute("data-selected","true")},t.prototype.decreaseQuantity=function(t){var e=this.getCardQuantity(t);if(e>0){var n=e-1;t.setAttribute("data-quantity",n.toString()),0===n&&t.removeAttribute("data-selected")}},t.prototype.getCardAmount=function(t){var e=t.getAttribute("data-amount");return e?parseFloat(e):0},t.prototype.getCardTitle=function(t){var e=t.querySelector("h1, h2, h3, h4, h5, h6");return e?e.innerText:""},t.prototype.getCurrencySymbol=function(t){if(t){var e=t.getAttribute("data-currency-symbol");if(e)return e;if(t.classList.contains("euro")||t.classList.contains("eur"))return this.currencies.EUR;if(t.classList.contains("pound")||t.classList.contains("gbp"))return this.currencies.GBP;if(t.classList.contains("dollar")||t.classList.contains("usd"))return this.currencies.USD;if(t.classList.contains("canadian")||t.classList.contains("cad"))return this.currencies.CAD;if(t.classList.contains("australian")||t.classList.contains("aud"))return this.currencies.AUD}var n=document.querySelector('[name="transaction.paycurrency"]');return n&&n.value in this.currencies?this.currencies[n.value]:"$"},t.prototype.getCurrencyCode=function(t){var e=t.getAttribute("data-currency-code");if(e)return e;if(t.classList.contains("euro")||t.classList.contains("eur"))return"EUR";if(t.classList.contains("pound")||t.classList.contains("gbp"))return"GBP";if(t.classList.contains("dollar")||t.classList.contains("usd"))return"USD";if(t.classList.contains("canadian")||t.classList.contains("cad"))return"CAD";if(t.classList.contains("australian")||t.classList.contains("aud"))return"AUD";var n=document.querySelector('[name="transaction.paycurrency"]');return n&&n.value in this.currencies?n.value:"USD"},t.prototype.getCurrencyPosition=function(t){return t.getAttribute("data-currency-position")||(t.classList.contains("currency-right")||t.closest(".sc-cards").classList.contains("currency-right")?"right":"left")},t.prototype.getCardQuantity=function(t){var e=t.getAttribute("data-quantity");return e?parseInt(e,10):0},t.prototype.watchForQuantityChanges=function(){var t=this,e=new MutationObserver((function(e){e.forEach((function(e){if("attributes"===e.type){var n=e.target,a=n.querySelector(".sc-cards-quantity > .quantity");a&&(a.innerText=t.getCardQuantity(n).toString()),t.rememberQuantity(),t.updateTotal()}}))}));this.cardsNode.forEach((function(t){e.observe(t,{attributes:!0,attributeFilter:["data-quantity"]})}))},t.prototype.addOtherAmount=function(){var t=this,e=document.querySelector(".block-other");if(e){var n=localStorage.getItem("sc-cards-".concat(this.getPageId(),"-other"))||"0";"0"!==n&&e.setAttribute("data-selected","true");var a=this.getCurrencySymbol(e),r=this.getCurrencyCode(e),i=document.createElement("div");i.classList.add("block-other-amount"),i.innerHTML='\n      <span class="currency-symbol">'.concat(a,'</span>\n      <input id="sc-other-amount" aria-label="Enter your custom donation amount" name="transaction.donationAmt.other-standin" type="text" inputmode="decimal" data-lpignore="true" autocomplete="off" value="').concat(n,'" tabindex="1">\n      <span class="currency-code">').concat(r,"</span>\n      "),e.appendChild(i);var c=e.querySelector("input");c&&(c.addEventListener("input",(function(n){var a=n.target.value||"0";localStorage.setItem("sc-cards-".concat(t.getPageId(),"-other"),a),"0"===a?e.removeAttribute("data-selected"):e.setAttribute("data-selected","true"),t.updateTotal()})),c.addEventListener("focus",(function(t){"0"===t.target.value&&(t.target.value="")})))}},t.prototype.addMonthlyCheckbox=function(){var t=this,e=document.querySelector(".monthly-checkbox");if(e){var n=localStorage.getItem("sc-cards-".concat(this.getPageId(),"-monthly"))||"N";"N"!==n&&e.setAttribute("data-selected","true");var a='\n      <input id="sc-monthly" value="Y" type="checkbox" '.concat("Y"===n?"checked='checked'":"",">\n      ");e.innerHTML=a+'<label for="sc-monthly">'+e.innerHTML+"</label>";var r=e.querySelector("input");r&&r.addEventListener("change",(function(n){var a=n.target.checked?"Y":"N";localStorage.setItem("sc-cards-".concat(t.getPageId(),"-monthly"),a),"N"===a?e.removeAttribute("data-selected"):e.setAttribute("data-selected","true"),t.updateFrequency(),t.updateTotal(),document.querySelectorAll(".frequency-buttons input").forEach((function(t){t.checked="onetime"===t.value&&"N"===a||"monthly"===t.value&&"Y"===a}))}))}},t.prototype.addLiveVariables=function(){var t=document.querySelectorAll(".en__component--copyblock, .en__component--codeblock, .en__submit button");t.length>0&&t.forEach((function(t){if(t.innerText.includes("[[")){var e=t.innerText.match(/\[\[(.*?)\]\]/g);e&&e.forEach((function(e){var n=e.replace(/\[\[/g,"").replace(/\]\]/g,"");t.innerHTML=t.innerHTML.replace("[[".concat(n,"]]"),"<span class='sc-live-variable' data-variable='"+n+"'></span>")}))}}))},t.prototype.updateLiveVariables=function(t,e){var n=document.querySelectorAll(".sc-live-variable[data-variable='"+t+"']");if(n.length>0&&n.forEach((function(t){t.innerText=e})),"FREQUENCY"===t){var a=document.querySelectorAll('[class*="show-frequency-"]'),r=""===e?"single":"monthly";a.forEach((function(t){t.classList.contains("show-frequency-".concat(r))?t.classList.remove("peta-hide"):t.classList.add("peta-hide")}))}},t.prototype.updateTotal=function(){var t=this;this.total=0,this.cartItems="",this.cardsNode.forEach((function(e){var n=t.getCardAmount(e),a=t.getCardQuantity(e),r=t.getCardTitle(e);a>0&&(t.cartItems="['".concat(a,"','").concat(r,"','").concat(n.toFixed(2),"'] \r\n").concat(t.cartItems)),t.total+=n*a}));var e=document.querySelector("#sc-other-amount");if(e){var n=parseFloat(parseFloat(e.value).toFixed(2));n>0&&(this.cartItems="['1','Other','".concat(n.toFixed(2),"'] \r\n").concat(this.cartItems),this.total+=n)}this.log("Shopping Cart Total:",this.total);var a=document.querySelector("[name='transaction.donationAmt.other']");a&&(a.value=this.total.toString()),window.EngagingNetworks.require._defined.enjs.setFieldValue("donationAmt",this.total);var r=document.querySelector('input[name="transaction.donationAmt.other"]');if(r&&""!==r.value){var i=new Event("keyup");r.dispatchEvent(i)}else{var c=document.querySelector('input[name="transaction.donationAmt"]:checked');if(c){var o=new Event("click");c.dispatchEvent(o)}}return this.total%1!=0?this.updateLiveVariables("TOTAL",this.total.toFixed(2)):this.updateLiveVariables("TOTAL",this.total.toString()),this.additionalComments.value=this.cartItems,this.total},t.prototype.updateFrequency=function(t){void 0===t&&(t="");var e=document.querySelector("#sc-monthly"),n=!1;e&&e.checked&&(n=!0),"monthly"===t?n=!0:"onetime"===t&&(n=!1);var a=n?"Y":"N";window.EngagingNetworks.require._defined.enjs.setFieldValue("recurrpay",a);var r=document.querySelectorAll('input[name="transaction.recurrpay"]');if(r.length>0&&r.forEach((function(t){t.value===a&&t.dispatchEvent(new Event("change"))})),"Y"===a&&window.EngagingNetworks.require._defined.enjs.setFieldValue("recurrfreq","MONTHLY"),"Y"===window.EngagingNetworks.require._defined.enjs.getFieldValue("recurrpay")){var i=document.querySelector("[name='transaction.recurrpay'][value='Y'] + label");i?this.updateLiveVariables("FREQUENCY",i.innerText):this.updateLiveVariables("FREQUENCY","Monthly")}else this.updateLiveVariables("FREQUENCY","")},t.prototype.setQuantityClickEvent=function(){var t=this;this.cardsNode.forEach((function(e){var n=e.querySelector(".sc-cards-quantity > .increase"),a=e.querySelector(".sc-cards-quantity > .decrease");n&&a&&(n.addEventListener("click",(function(){t.increaseQuantity(e)})),a.addEventListener("click",(function(){t.decreaseQuantity(e)})))}))},t.prototype.rememberQuantity=function(){var t=this,e=[];this.cardsNode.forEach((function(n,a){e[a]=t.getCardQuantity(n)})),localStorage.setItem("sc-cards-".concat(this.getPageId()),JSON.stringify(e))},t.prototype.getPageId=function(){var t;return"pageJson"in window?null===(t=null===window||void 0===window?void 0:window.pageJson)||void 0===t?void 0:t.campaignPageId:0},t.prototype.isDebug=function(){var t=new RegExp("[\\?&]debug=([^&#]*)").exec(location.search);return null===t?"":decodeURIComponent(t[1].replace(/\+/g," "))},t.prototype.checkDebug=function(){this.isDebug()&&document.querySelector("body").setAttribute("data-debug","true")},t.prototype.checkNested=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var a=0;a<e.length;a++){if(!t||!Object.getOwnPropertyDescriptor(t,e[a]))return!1;t=t[e[a]]}return!0},t.prototype.createAdditionalComments=function(){var t,e=document.createElement("div");e.classList.add("en__component","en__component--formblock","hide");var n=document.createElement("div");n.classList.add("en__field","en__field--text");var a=document.createElement("div");a.classList.add("en__field__element","en__field__element--text");var r=document.createElement("textarea");r.classList.add("en__field__input","en__field__input--textarea","foursite-shopping-cart-added-input"),r.setAttribute("name","transaction.comments"),r.setAttribute("value",""),this.isDebug()&&(r.style.width="100%",r.setAttribute("placeholder","Additional Comments (Debug Mode)")),a.appendChild(r),n.appendChild(a),e.appendChild(n);var i=document.querySelector(".en__submit");if(i){var c=i.closest(".en__component");c&&(null===(t=c.parentNode)||void 0===t||t.insertBefore(e,c.nextSibling))}else{var o=document.querySelector("form");o&&o.appendChild(e)}this.additionalComments=r},t.prototype.log=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];this.isDebug()&&console.log(t,e)},t}())})();